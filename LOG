PYTHONPATH=${PYTHONPATH}:$(pwd) python train/train.py --root /scratch3/data/guess_disent/dshapes_split_color_vs_ori_size --crop 64 --flip=0 --out /scratch3/run/dom_diff_inter/shapes_run3

CUDA_VISIBLE_DEVICES=0 python train.py --batch_size=4 --checkpoints_dir=//scratch3/run/better_cg_old_p2p --dataroot=/scratch3/data/guess_disent/dshapes_split_color_vs_ori_size/ --dataset_mode=gta2segm --lambda_A=1.0 --lambda_B=2.0 --model=cycle_gan_guess_noisy_mod --name=shapes_cyclegan_guess_la_1_lb_2_lg_2_sigma_01_mod --no_flip --crop_size=64 --load_size=64

CUDA_VISIBLE_DEVICES=0 python -m pdb train_disent.py --dataset_globs='/scratch3/data/guess_disent/dshapes_split_color_vs_ori_size/trainA/*.png:/scratch3/data/guess_disent/dshapes_split_color_vs_ori_size/trainB/*.png:/scratch3/data/guess_disent/dshapes_split_color_vs_ori_size/testA/*.png:/scratch3/data/guess_disent/dshapes_split_color_vs_ori_size/testB/*.png' --output_dir=/scratch3/run/better_cg/train_dis_shape_guess2_noise05_idt1_cyc10_srec1_sidt0_snorm1/$(date +"%m%d-%H%M")/ --load_size=64 --crop_size=64 --flip=false --guess_loss_weight=2.0 --identity_loss_weight=1.0 --defence_noise_sigma=0.5 --batch_size=2 --style_rec_weight=1.0 --style_norm_weight=1.0

CUDA_VISIBLE_DEVICES=0 python -m pdb train_disent.py --dataset=dshapes_split_color_vs_ori_size --output_dir=/scratch3/run/better_cg/train_dis_shape_guess2_inoise05_snoise03_idt1_cyc10_srec2_sidt0_snorm05_sind1_sren1/$(date +"%m%d-%H%M")/ --load_size=64 --crop_size=64 --flip=false --guess_loss_weight=2.0 --identity_loss_weight=1.0 --defence_img_noise_sigma=0.5 --defence_style_noise_sigma=0.3 --batch_size=2 --style_rec_weight=2.0 --style_norm_weight=0.5 --style_img_indep_weight=1.0 --renorm_random_styles=true

= TO RUN

CUDA_VISIBLE_DEVICES=0 python train_disent_v1.py --dataset=dshapes_split_color_vs_ori_size --output_dir=/scratch3/run/better_cg/train_dis_shape_v1_perm_guess2_inoise05_snoise05_idt1_cyc10_srec1_snorm1/$(date +"%m%d-%H%M")/ --load_size=64 --crop_size=64 --flip=false --guess_loss_weight=2.0 --identity_loss_weight=1.0 --defence_img_noise_sigma=0.5 --defence_style_noise_sigma=0.5 --batch_size=2 --style_rec_weight=1.0 --style_norm_weight=1.0 --style_indep_weight=1.0

CUDA_VISIBLE_DEVICES=0 python -m pdb -c cont train_disent_v1_1.py --dataset=dshapes_split_color_vs_ori_size --output_dir=/scratch3/run/better_cg/train_dis_shape_guess2_noise05_idt1_cyc10_srec1_sidt0_snorm1/$(date +"%m%d-%H%M")/ --load_size=64 --crop_size=64 --flip=false --guess_loss_weight=2.0 --identity_loss_weight=1.0 --defence_noise_sigma=0.5 --batch_size=2 --style_rec_weight=1.0 --style_norm_weight=1.0

CUDA_VISIBLE_DEVICES=0 python train_disent_v1_2.py --output_dir=/scratch3/run/better_cg/train_dis_shape_guess2_noise05_idt1_cyc10_srec1_sidt0_snorm1_gt1/$(date +"%m%d-%H%M")/ --load_size=64 --crop_size=64 --flip=false --guess_loss

for i in {0..9}; do \
XID=$(date +'%m%d-%H%M')_${i}; EXP="27_rep_bs16_sn2_ssr1_dz05_sz05_gs2_cyc10_lr1e4"; \
sbatch --job-name="${EXP}/${XID}" --output="/research/dbash/usmn/slurm/%j_${XID}.out" \
--partition=gpu-L --gres=gpu:1 --constraint='gpu6' --wrap="python train_disent_v1_2_7.py \
--gt_main_dataset_root='/research/dbash/usmn/data/guess_disent' \
--gt_main_attr_clf_model_root='/research/dbash/usmn/run/attr_models/' \
--gt_dataset_name=dshapes_split_color_vs_ori_size \
--output_dir=/research/dbash/usmn/run/shapes/${EXP}/${XID}/ \
--load_size=64 --crop_size=64 --flip=false --guess_loss_weight=2.0 \
--identity_loss_weight=1.0 --defence_noise_sigma=0.5 --style_noise_sigma=0.5 \
--batch_size=16 --style_rand_rec_weight=1.0 --style_zero_rec_weight=0.0 \
--style_idt_rec_weight=0.0 --style_norm_weight=2.0 --gt_data_weight=0.0 \
--cycle_loss_weight=10.0 --lr=0.0001"; done


for i in {0..9}; do \
XID=$(date +'%m%d-%H%M')_${i}; EXP="216_sn2_ssr1_ssw0_csw0_dz05_sz05_gs2_cyc10_shuf0_glr1e4_dlr1e4"; \
sbatch --job-name="${EXP}/${XID}" --output="/research/dbash/usmn/slurm/%j_${XID}.out" \
--partition=gpu-L --gres=gpu:1 --constraint='gpu6' --wrap="python train_disent_v1_2_16.py \
--gt_main_dataset_root='/research/dbash/usmn/data/guess_disent' \
--gt_main_attr_clf_model_root='/research/dbash/usmn/run/attr_models/' \
--gt_dataset_name=dshapes_split_color_vs_ori_size \
--output_dir=/research/dbash/usmn/run/shapes/${EXP}/${XID}/ \
--load_size=64 --crop_size=64 --flip=false  --guess_loss_weight=2.0 --identity_loss_weight=1.0 \
--defence_noise_sigma=0.5 --style_noise_sigma=0.5 --batch_size=8 --cycle_swap_weight=0.0 \
--style_swap_rec_weight=0.0 --style_rand_rec_weight=1.0 --style_norm_weight=2.0 --gt_data_weight=0.0 \
--cycle_loss_weight=10.0 --gen_lr=1e-4 --dis_lr=1e-4 --shuffle_supervised_pairs_buffer=0"; done

for i in {0..9}; do \
XID=$(date +'%m%d-%H%M')_${i}; EXP="216_sn2_ssr1_ssw0_csw0_dz05_sz05_gs2_cyc10_shuf0_bs16_glr1e4_dlr1e4"; \
sbatch --job-name="${EXP}/${XID}" --output="/research/dbash/usmn/slurm/%j_${XID}.out" \
--partition=gpu-L --gres=gpu:1 --constraint='gpu6' --cpus-per-gpu=4 \
--wrap="python train_disent_v1_2_16.py --gt_main_dataset_root='/research/dbash/usmn/data/guess_disent' \
--gt_main_attr_clf_model_root='/research/dbash/usmn/run/attr_models/' --gt_dataset_name=dshapes_split_color_vs_ori_size \
--output_dir=/research/dbash/usmn/run/shapes/${EXP}/${XID}/ --load_size=64 --crop_size=64 --flip=false \
 --guess_loss_weight=2.0 --identity_loss_weight=1.0 --defence_noise_sigma=0.5 --style_noise_sigma=0.5 \
 --batch_size=16 --cycle_swap_weight=0.0 --style_swap_rec_weight=0.0 --style_rand_rec_weight=1.0 \
 --style_norm_weight=2.0 --gt_data_weight=0.0 --cycle_loss_weight=10.0 \
 --gen_lr=1e-4 --dis_lr=1e-4 --shuffle_supervised_pairs_buffer=0"; done


for i in {0..9}; do \
XID=$(date +'%m%d-%H%M')_${i}; EXP="27_rep_bs16_sn2_ssr1_dz05_sz05_gs2_cyc10_lr1e4"; \
sbatch --job-name="${EXP}/${XID}" --output="/research/dbash/usmn/slurm/%j_${XID}.out" \
--partition=gpu-L --gres=gpu:1 --constraint='gpu6' --wrap="python train_disent_v1_2_7.py \
--gt_main_dataset_root='/research/dbash/usmn/data/guess_disent' \
--gt_main_attr_clf_model_root='/research/dbash/usmn/run/attr_models/' \
--gt_dataset_name=dshapes_fhue_shape_vs_ori_ohue \
--output_dir=/research/dbash/usmn/run/shapes_fh/${EXP}/${XID}/ \
--load_size=64 --crop_size=64 --flip=false --guess_loss_weight=2.0 \
--identity_loss_weight=1.0 --defence_noise_sigma=0.5 --style_noise_sigma=0.5 \
--batch_size=16 --style_rand_rec_weight=1.0 --style_zero_rec_weight=0.0 \
--style_idt_rec_weight=0.0 --style_norm_weight=2.0 --gt_data_weight=0.0 \
--cycle_loss_weight=10.0 --lr=0.0001"; done


find ${PWD}/A -name '*.png' | xargs -I{} ln -s {} all/
find ${PWD}/B -name '*.png' | xargs -I{} ln -s {} all/
squeue | grep usmn | tr -s ' ' | cut -d' ' -f2

sort <(ls A B) | uniq -d > dups.txt


i=0; EXP_ROOT=/scratch3/run/honest_disent/shapes; XID=$(date +'%m%d-%H%M')_${i}; \
EXP="216_from0913-1417-0-15_sn2_ssr1_ssw0_csw0_dz05_sz05_gs2_cyc10_shuf0_bs16_glr1e4_dlr1e4"; \
python train_disent_v1_2_16.py \
--restore_from=/scratch3/run/honest_disent/shapes/27_sn2_gs2_cyc10_lr1e4/0913-1417_0/checkpoints/ckpt-15 \
--gt_dataset_name=dshapes_split_color_vs_ori_size \
--output_dir=${EXP_ROOT}/${EXP}/${XID}/ \
--load_size=64 --crop_size=64 --flip=false  --guess_loss_weight=2.0 --identity_loss_weight=1.0 \
--defence_noise_sigma=0.5 --style_noise_sigma=0.5 --batch_size=8 --cycle_swap_weight=0.0 \
--style_swap_rec_weight=0.0 --style_rand_rec_weight=1.0 --style_norm_weight=2.0 --gt_data_weight=0.0 \
--cycle_loss_weight=10.0 --gen_lr=1e-4 --dis_lr=1e-4 --shuffle_supervised_pairs_buffer=0


for i in {0..9}; do \
XID=$(date +'%m%d-%H%M')_${i}; EXP="27_rep_bs16_sn2_ssr1_dz05_sz05_gs2_cyc10_lr1e4"; \
sbatch --job-name="${EXP}/${XID}" --output="/research/dbash/usmn/slurm/%j_${XID}.out" \
--partition=gpu-L --gres=gpu:1 --cpus-per-gpu=4 --wrap="python train_disent_v1_2_7.py \
--gt_main_dataset_root='/research/dbash/usmn/data/guess_disent' \
--gt_main_attr_clf_model_root='/research/dbash/usmn/run/attr_models/' \
--gt_dataset_name=dshapes_fhue_shape_vs_ori_ohue \
--output_dir=/research/dbash/usmn/run/shapes_fh/${EXP}/${XID}/ \
--load_size=64 --crop_size=64 --flip=false --guess_loss_weight=2.0 \
--identity_loss_weight=1.0 --defence_noise_sigma=0.5 --style_noise_sigma=0.5 \
--batch_size=16 --style_rand_rec_weight=1.0 --style_zero_rec_weight=0.0 \
--style_idt_rec_weight=0.0 --style_norm_weight=2.0 --gt_data_weight=0.0 \
--cycle_loss_weight=10.0 --lr=0.0001"; done

train_disent_v1_2_16.py --gt_dataset_name=dshapes_fhue_shape_vs_ori_ohue \
--output_dir=/scratch3/run/honest_disent/shapes_fh/216_sn2_ssw05_csw3_dz05_sz05_gs2_cyc10_glr1e4_dlr5e5/${XID}/ \
--load_size=64 --crop_size=64 --flip=false "; screen -X stuff " \
--guess_loss_weight=2.0 --identity_loss_weight=1.0 --defence_noise_sigma=0.5 --style_noise_sigma=0.5 --batch_size=8 --cycle_swap_weight=3.0 --style_swap_rec_weight=0.5 --style_norm_weight=2.0 --gt_data_weight=0.0 --cycle_loss_weight=10.0 --gen_lr=0.0001 --dis_lr=5e-5 --shuffle_supervised_pairs_buffer=100

for i in {0..9}; do \
XID=$(date +'%m%d-%H%M')_${i}; EXP="shapes_oh/216_bs16_sn2_ssw05_csw3_dz05_sz05_gs2_cyc10_glr1e4_dlr5e5"; \
sbatch --job-name="${EXP}/${XID}" --output="/research/dbash/usmn/slurm/%j_${XID}.out" \
--partition=gpu-L --gres=gpu:1 --cpus-per-gpu=4 --wrap="python train_disent_v1_2_16.py \
--gt_main_dataset_root='/research/dbash/usmn/data/guess_disent' --gt_main_attr_clf_model_root='/research/dbash/usmn/run/attr_models/' \
--gt_dataset_name=dshapes_ohue_size_vs_shape_whue --output_dir=/research/dbash/usmn/run/${EXP}/${XID}/ \
--load_size=64 --crop_size=64 --flip=false \
--guess_loss_weight=2.0 --identity_loss_weight=1.0 --defence_noise_sigma=0.5 --style_noise_sigma=0.5 \
--batch_size=16 --cycle_swap_weight=3.0 --style_swap_rec_weight=0.5 --style_norm_weight=2.0 --gt_data_weight=0.0 \
--cycle_loss_weight=10.0 --gen_lr=0.0001 --dis_lr=5e-5 --shuffle_supervised_pairs_buffer=100"; done


/scratch2/dinka/synaction_new_disentanglement/trans/
/scratch2/dinka/dshapes_ohue_disentanglement/trans/
/scratch2/dinka/dshapes_disentanglement/ours_transl/

# can not use --resize 64 because of arch
PYTHONPATH=${PYTHONPATH}:$(pwd) python train/train.py --root /home/grad2/usmn/projects/better_cg/DomainIntersectionDifference/root_files/synaction_v3/ --crop 256 --flip=0 --out /scratch3/run/dom_diff_inter/synact_v3

PYTHONPATH=${PYTHONPATH}:$(pwd) python eval.py --root /scratch3/data/guess_disent/dshapes_split_color_vs_ori_size --crop 64 \
--flip=0 --load /scratch3/run/dom_diff_inter/shapes_run3/checkpoint --out /scratch3/run/dom_diff_inter/shapes_run3/result

python eval.py --root /scratch3/data/guess_disent/dshapes_split_color_vs_ori_size --crop 64 --load /scratch3/run/dom_diff_inter/shapes_run3/ --out /scratch3/run/dom_diff_inter/shapes_run3/result

seq 0 $(($(cat /scratch3/data/guess_disent/dshapes_split_color_vs_ori_size/trainB.txt | wc -l) / 64)) | \
while read skip; do \
CUDA_VISIBLE_DEVICES=1 python eval_full.py --root /scratch3/data/guess_disent/dshapes_split_color_vs_ori_size --crop 64 \
--load /scratch3/run/dom_diff_inter/shapes_run3/ --out /scratch3/run/dom_diff_inter/shapes_run3/result --BtoA=1 \
--num_display=64 --skip=${skip}; \
done


seq 0 $(($(cat /scratch3/data/guess_disent/dshapes_split_color_vs_ori_size/trainA.txt | wc -l) / 64)) | \
while read skip; do \
CUDA_VISIBLE_DEVICES=1 python eval_full.py --root /scratch3/data/guess_disent/dshapes_split_color_vs_ori_size --crop 64 \
--load /scratch3/run/dom_diff_inter/shapes_run3/ --out /scratch3/run/dom_diff_inter/shapes_run3/result --BtoA=1 \
--num_display=64 --skip=${skip}; \
done

seq 0 $(($(cat /scratch3/data/guess_disent/dshapes_split_color_vs_ori_size/trainA.txt | wc -l) / 64)) | \
while read skip; do \
CUDA_VISIBLE_DEVICES=1 python eval_full.py --root /scratch3/data/guess_disent/dshapes_split_color_vs_ori_size \
--crop 64 --load /scratch3/run/dom_diff_inter/shapes_run3/ --out /scratch3/run/dom_diff_inter/shapes_run3/result \
--num_display=64 --skip=${skip}; done

CUDA_VISIBLE_DEVICES=0 PYTHONPATH=${PYTHONPATH}:$(pwd) python \
train/train.py --root ~/projects/better_cg/DomainIntersectionDifference/root_files/synaction_v3/ \
--crop 256 --flip=0 --out /scratch3/run/dom_diff_inter/synact_v3_run2

for split in train test; do for d in A B; do \
find /scratch3/data/guess_disent/dshapes_fhue_shape_vs_ori_ohue/${d} -name '*.png' > \
/home/grad2/usmn/projects/better_cg/DomainIntersectionDifference/root_files/shapes_fh/${split}${d}.txt;
done; done

CUDA_VISIBLE_DEVICES=1 PYTHONPATH=${PYTHONPATH}:$(pwd) python \
train/train.py --root /home/grad2/usmn/projects/better_cg/DomainIntersectionDifference/root_files/shapes_fh/ \
--crop 64 --flip=0 --out /scratch3/run/dom_diff_inter/shapes_fh

for split in train test; do for d in A B; do \
find /scratch3/data/guess_disent/dshapes_ohue_size_vs_shape_whue/${d} -name '*.png' > \
/home/grad2/usmn/projects/better_cg/DomainIntersectionDifference/root_files/shapes_oh/${split}${d}.txt;
done; done

CUDA_VISIBLE_DEVICES=2 PYTHONPATH=${PYTHONPATH}:$(pwd) python \
train/train.py --root /home/grad2/usmn/projects/better_cg/DomainIntersectionDifference/root_files/shapes_oh/ \
--crop 64 --flip=0 --out /scratch3/run/dom_diff_inter/shapes_oh

for split in train test; do for d in A B; do \
cat /home/grad2/usmn/projects/better_cg/DomainIntersectionDifference/root_files/shapes_oh/${split}${d}.txt \
| shuf > /home/grad2/usmn/projects/better_cg/DomainIntersectionDifference/root_files/shapes_oh/${split}${d}_shuf.txt;
mv /home/grad2/usmn/projects/better_cg/DomainIntersectionDifference/root_files/shapes_oh/${split}${d}.txt /home/grad2/usmn/projects/better_cg/DomainIntersectionDifference/root_files/shapes_oh/${split}${d}_unshuf.txt; \
mv /home/grad2/usmn/projects/better_cg/DomainIntersectionDifference/root_files/shapes_oh/${split}${d}_shuf.txt /home/grad2/usmn/projects/better_cg/DomainIntersectionDifference/root_files/shapes_oh/${split}${d}.txt; \
done; done

for split in train test; do for d in A B; do \
cat /home/grad2/usmn/projects/better_cg/DomainIntersectionDifference/root_files/shapes_fh/${split}${d}.txt \
| shuf > /home/grad2/usmn/projects/better_cg/DomainIntersectionDifference/root_files/shapes_fh/${split}${d}_shuf.txt;
mv /home/grad2/usmn/projects/better_cg/DomainIntersectionDifference/root_files/shapes_fh/${split}${d}.txt /home/grad2/usmn/projects/better_cg/DomainIntersectionDifference/root_files/shapes_fh/${split}${d}_unshuf.txt; \
mv /home/grad2/usmn/projects/better_cg/DomainIntersectionDifference/root_files/shapes_fh/${split}${d}_shuf.txt /home/grad2/usmn/projects/better_cg/DomainIntersectionDifference/root_files/shapes_fh/${split}${d}.txt; \
done; done


seq 0 $(($(cat ~/projects/better_cg/DomainIntersectionDifference/root_files/synaction_v3/trainB.txt | wc -l) / 64)) | \
while read skip; do \
CUDA_VISIBLE_DEVICES=0 python eval_full.py --root ~/projects/better_cg/DomainIntersectionDifference/root_files/synaction_v3 --crop 256 \
--load /scratch3/run/dom_diff_inter/synact_v3_run2/ --out /scratch3/run/dom_diff_inter/synact_v3_run2/result --BtoA=1 \
--num_display=64 --skip=${skip}; \
done

seq 0 $(($(cat ~/projects/better_cg/DomainIntersectionDifference/root_files/synaction_v3/trainA.txt | wc -l) / 64)) | \
while read skip; do \
CUDA_VISIBLE_DEVICES=0 python eval_full.py --root ~/projects/better_cg/DomainIntersectionDifference/root_files/synaction_v3 --crop 256 \
--load /scratch3/run/dom_diff_inter/synact_v3_run2/ --out /scratch3/run/dom_diff_inter/synact_v3_run2/result \
--num_display=64 --skip=${skip}; \
done

% ---

export CUDA_VISIBLE_DEVICES=1
ROOT_FOLDER=/home/grad2/usmn/projects/better_cg/DomainIntersectionDifference/root_files
ROOT_FILE=shapes_oh
RUN_FOLDER=/scratch3/run/dom_diff_inter/shapes_oh_shuf
IMG_SIZE=64

seq 0 $(($(cat ${ROOT_FOLDER}/${ROOT_FILE}/trainB.txt | wc -l) / 64)) | \
while read skip; do \
python eval_full.py --root ${ROOT_FOLDER}/${ROOT_FILE} --crop 64 \
--load ${RUN_FOLDER} --out ${RUN_FOLDER}/result --num_display=64 --skip=${skip} --BtoA=1; \
done

seq 0 $(($(cat ${ROOT_FOLDER}/${ROOT_FILE}/trainA.txt | wc -l) / 64)) | \
while read skip; do \
python eval_full.py --root ${ROOT_FOLDER}/${ROOT_FILE} --crop 64 \
--load ${RUN_FOLDER} --out ${RUN_FOLDER}/result --num_display=64 --skip=${skip}; \
done

% ---

export CUDA_VISIBLE_DEVICES=1
ROOT_FOLDER=/home/grad2/usmn/projects/better_cg/DomainIntersectionDifference/root_files
ROOT_FILE=shapes_test
RUN_FOLDER=/scratch3/run/dom_diff_inter/shapes_run3/
IMG_SIZE=64

python eval_batch.py --root ${ROOT_FOLDER}/${ROOT_FILE} --crop 64 \
--load ${RUN_FOLDER} --out ${RUN_FOLDER}/result_viz --num_display=6

python eval_batch.py --root ${ROOT_FOLDER}/${ROOT_FILE} --crop 64 \
--load ${RUN_FOLDER} --out ${RUN_FOLDER}/result_viz --num_display=6 --BtoA

% ---

rsync -azvh /scratch3/run/dom_diff_inter/synact_v3_run2/result/crop/  geoffrey:/scratch2/dinka/synaction_new_disentanglement/trans/didd
rsync -azvh /scratch3/run/dom_diff_inter/shapes_fh_shuf/result/crop/  geoffrey:/scratch2/dinka/dshapes_fhue_disentanglement/trans/didd
rsync -azvh /scratch3/run/dom_diff_inter/shapes_oh_shuf/result/crop/  geoffrey:/scratch2/dinka/dshapes_ohue_disentanglement/trans/didd
rsync -azvh /scratch3/run/honest_disent/shapes_oh/216_bs16_sn2_ssw05_csw3_dz05_sz05_gs2_cyc10_glr1e4_dlr5e5/1029-1635_5/result/ckpt-109 geoffrey:/scratch2/dinka/dshapes_ohue_disentanglement/trans/OUR/1029-1635-5-109

% ---

new generated results
/scratch2/dinka/dshapes_disentanglement/ours_transl/OUR/0913-1417-0-15
/scratch2/dinka/dshapes_fhue_disentanglement/trans/OUR/1019-1512-0-49
/scratch2/dinka/dshapes_ohue_disentanglement/trans/OUR/1029-1635-5-109
/scratch2/dinka/synaction_new_disentanglement/trans/OUR/0926-1649-1-41

/scratch2/dinka/dshapes_disentanglement/ours_transl/DIDD
/scratch2/dinka/dshapes_fhue_disentanglement/trans/DIDD
/scratch2/dinka/dshapes_ohue_disentanglement/trans/DIDD
/scratch2/dinka/synaction_new_disentanglement/trans/DIDD


# inside /scratch2/dinka/dshapes_fhue_disentanglement/trans

cd /scratch2/dinka/eval_umi2i/dshapes_disentanglement/ours_transl/; \
cat /research/dbash/usmn/data/guess_disent/dshapes_split_color_vs_ori_size/dups.txt | \
while read line; do find . -name "*${line%.*}*.png" -not -path "./trash/*" | \
while read fn; do echo mkdir -p trash/${fn%/*}; echo mv $fn trash/${fn}; done; done | wc -l

cd /scratch2/dinka/eval_umi2i/dshapes_fhue_disentanglement/trans/; \
cat /research/dbash/usmn/data/guess_disent/dshapes_fhue_shape_vs_ori_ohue/dups.txt | \
while read line; do find . -name "*${line%.*}*.png" -not -path "./trash/*" | \
while read fn; do echo mkdir -p trash/${fn%/*}; echo mv $fn trash/${fn}; done; done | wc -l

cd /scratch2/dinka/eval_umi2i/dshapes_ohue_disentanglement/trans/; \
cat /research/dbash/usmn/data/guess_disent/dshapes_ohue_size_vs_shape_whue/dups.txt | \
while read line; do find . -name "*${line%.*}*.png" -not -path "./trash/*" | \
while read fn; do echo mkdir -p trash/${fn%/*}; echo mv $fn trash/${fn}; done; done | wc -l


% ---


for i in {0..9}; do \
XID=$(date +'%m%d-%H%M')_${i}; EXP="27_rep_bs8_sn2_ssr1_dz05_sz05_gs2_cyc10_lr1e4"; \
sbatch --job-name="${EXP}/${XID}" --output="/research/dbash/usmn/slurm/%j_${XID}.out" \
--partition=gpu-L --gres=gpu:1 --cpus-per-gpu=4 --wrap="python train_disent_v1_2_7.py \
--gt_main_dataset_root='/research/dbash/usmn/data/guess_disent' \
--gt_main_attr_clf_model_root='/research/dbash/usmn/run/attr_models/' \
--gt_dataset_name=dshapes_split_color_vs_ori_size \
--output_dir=/research/dbash/usmn/run/shapes/${EXP}/${XID}/ \
--load_size=64 --crop_size=64 --flip=false --guess_loss_weight=2.0 \
--identity_loss_weight=1.0 --defence_noise_sigma=0.5 --style_noise_sigma=0.5 \
--batch_size=8 --style_rand_rec_weight=1.0 --style_zero_rec_weight=0.0 \
--style_idt_rec_weight=0.0 --style_norm_weight=2.0 --gt_data_weight=0.0 \
--cycle_loss_weight=10.0 --lr=0.0001"; done



rsync -azvh /scratch3/run/honest_disent/shapes/216_from0913-1417-0-15_sn2_ssr1_ssw0_csw0_dz05_sz05_gs2_cyc10_shuf0_bs16_glr1e4_dlr1e4/1103-1028_0/result/ckpt-18/ geoffrey:/scratch2/dinka/dshapes_disentanglement/ours_transl/OUR/1103-1028-0-18
rsync -azvh /scratch3/run/better_cg/re_23_sn2/0803-1901/result/ckpt-17/ geoffrey:/scratch2/dinka/dshapes_disentanglement/ours_transl/OUR/0803-1901-00-17


CUDA_VISIBLE_DEVICES=2 PYTHONPATH=${PYTHONPATH}:$(pwd) python \
train/train.py --root /home/grad2/usmn/projects/better_cg/DomainIntersectionDifference/root_files/celeba/ \
--crop 174 --flip=1 --out /scratch3/run/dom_diff_inter/celeba


vis paths
original celeba: 
/scratch3/data/celeba_split2/split2/train_test/vis{A,B}/

original dshapes: 
/scratch3/data/guess_disent/dshapes_split_color_vs_ori_size/vis_examples/domain{A,B}/

generated dhsapes:
/scratch2/dinka/dshapes_disentanglement/vis_examples/

generated celeba
/scratch2/dinka/celeba_disentanglement/viz_examples/

for i in {0..9}; do \
XID=$(date +'%m%d-%H%M')_${i}; EXP="216_sw2_rep_sn1_ssw1_csw3_dz1_2_sz03_gs4_cyc10_glr1e4_dlr5e5"; \
sbatch --job-name="${EXP}/${XID}" --output="/research/dbash/usmn/slurm/%j_${XID}.out" \
--partition=gpu-L --gres=gpu:1 --cpus-per-gpu=4 --wrap="python train_disent_v1_2_16.py \
--gt_main_dataset_root='/research/dbash/usmn/data/guess_disent' \
--gt_main_attr_clf_model_root='/research/dbash/usmn/run/attr_models/' \
--gt_dataset_name=celeba_custom_split_sw2 \
--output_dir=/research/dbash/usmn/run/celeba/${EXP}/${XID}/ \
--load_size=64 --crop_size=64 --flip=false \
--guess_loss_weight=4.0 --identity_loss_weight=1.0 --defence_noise_sigma=1.2 \
--style_noise_sigma=0.3 --batch_size=8 --cycle_swap_weight=3.0 \
--style_swap_rec_weight=1.0 --style_norm_weight=1.0 --gt_data_weight=0.0 \
--cycle_loss_weight=10.0 --gen_lr=0.0001 --dis_lr=5e-5 \
--shuffle_supervised_pairs_buffer=100"; done

% ---

export CUDA_VISIBLE_DEVICES=2
ROOT_FOLDER=/home/grad2/usmn/projects/better_cg/DomainIntersectionDifference/root_files
ROOT_FILE=celeba_test
RUN_FOLDER=/scratch3/run/dom_diff_inter/celeba/

python eval_batch.py --root ${ROOT_FOLDER}/${ROOT_FILE} --crop 174 \
--load ${RUN_FOLDER} --out ${RUN_FOLDER}/result_viz --num_display=16

python eval_batch.py --root ${ROOT_FOLDER}/${ROOT_FILE} --crop 174 \
--load ${RUN_FOLDER} --out ${RUN_FOLDER}/result_viz --num_display=16 --BtoA=1

% ---

export CUDA_VISIBLE_DEVICES=0
ROOT_FOLDER=/home/grad2/usmn/projects/better_cg/DomainIntersectionDifference/root_files
ROOT_FILE=celeba
RUN_FOLDER=/scratch3/run/dom_diff_inter/celeba
IMG_SIZE=64

seq 0 $(($(cat ${ROOT_FOLDER}/${ROOT_FILE}/trainB.txt | wc -l) / 64)) | \
while read skip; do \
python eval_full.py --root ${ROOT_FOLDER}/${ROOT_FILE} --crop 174 \
--load ${RUN_FOLDER} --out ${RUN_FOLDER}/result --num_display=64 --skip=${skip} --BtoA=1; \
done

seq 0 $(($(cat ${ROOT_FOLDER}/${ROOT_FILE}/trainA.txt | wc -l) / 64)) | \
while read skip; do \
python eval_full.py --root ${ROOT_FOLDER}/${ROOT_FILE} --crop 174 \
--load ${RUN_FOLDER} --out ${RUN_FOLDER}/result --num_display=64 --skip=${skip}; \
done

% ---

for i in {0..9}; do \
XID=$(date +'%m%d-%H%M')_${i}; EXP="216_sw2_from_best_1105-1415_3_sn1_ssw1_csw3_dz1_2_sz03_gs4_cyc10_glr1e4_dlr5e5"; \
sbatch --job-name="${EXP}/${XID}" --output="/research/dbash/usmn/slurm/%j_${XID}.out" \
--partition=gpu-L --gres=gpu:1 --cpus-per-gpu=4 --wrap="python train_disent_v1_2_16.py \
--restore_from=/research/dbash/usmn/run/celeba/best_restart/216_1105-1415_3/ckpt-46 \
--gt_main_dataset_root='/research/dbash/usmn/data/guess_disent' \
--gt_main_attr_clf_model_root='/research/dbash/usmn/run/attr_models/' \
--gt_dataset_name=celeba_custom_split_sw2 \
--output_dir=/research/dbash/usmn/run/celeba/${EXP}/${XID}/ \
--load_size=64 --crop_size=64 --flip=false \
--guess_loss_weight=4.0 --identity_loss_weight=1.0 --defence_noise_sigma=1.2 \
--style_noise_sigma=0.3 --batch_size=8 --cycle_swap_weight=3.0 \
--style_swap_rec_weight=1.0 --style_norm_weight=1.0 --gt_data_weight=0.0 \
--cycle_loss_weight=10.0 --gen_lr=0.0001 --dis_lr=5e-5 \
--shuffle_supervised_pairs_buffer=100"; done

% ---


for i in {0..1}; do \
XID=$(date +'%m%d-%H%M')_${i}; EXP="216_sw2_from_best_1105_1415_3_sn1_ssw1_csw3_dz1_2_sz03_gs4_cyc10_glr5e5_dlr1e5"; \
sbatch --job-name="${EXP}/${XID}" --output="/research/dbash/usmn/slurm/%j_${XID}.out" \
--partition=gpu-L --gres=gpu:1 --cpus-per-gpu=4 --constraint='gpu8|gpu9|gpu10' \
--wrap="python train_disent_v1_2_16.py \
--restore_from=/research/dbash/usmn/run/celeba/best_restart/216_1105-1415_3/ckpt-46 \
--gt_main_dataset_root='/research/dbash/usmn/data/guess_disent' \
--gt_main_attr_clf_model_root='/research/dbash/usmn/run/attr_models/' \
--gt_dataset_name=celeba_custom_split_sw2 \
--output_dir=/research/dbash/usmn/run/celeba/${EXP}/${XID}/ \
--load_size=64 --crop_size=64 --flip=false \
--guess_loss_weight=4.0 --identity_loss_weight=1.0 --defence_noise_sigma=1.2 \
--style_noise_sigma=0.3 --batch_size=8 --cycle_swap_weight=3.0 \
--style_swap_rec_weight=1.0 --style_norm_weight=1.0 --gt_data_weight=0.0 \
--cycle_loss_weight=10.0 --gen_lr=5e-5 --dis_lr=1e-5 \
--shuffle_supervised_pairs_buffer=100"; done

s=(1 2 3 4 5 6); g=(0 0 1 1 2 2); for i in ${!s[@]}; do \
XID=$(date +'%m%d-%H%M')_${i}; screen -X select ${s[i]}; screen -X title "${XID}@${g[i]}"; \
screen -X stuff "CUDA_VISIBLE_DEVICES=${g[i]} python train_disent_v1_2_7.py \
--gt_dataset_name=dshapes_split_color_vs_ori_size \
--output_dir=/scratch3/run/honest_disent/shapes/27_abl_srr1_no_defence_no_noise_no_norm/${XID}/ \
--load_size=64 --crop_size=64 --flip=false "; screen -X stuff " --guess_loss_weight=0.0 \
--identity_loss_weight=1.0 --defence_noise_sigma=0.0 --style_noise_sigma=0.0 --batch_size=8 \
--style_rand_rec_weight=1.0 --style_zero_rec_weight=0.0 --style_idt_rec_weight=0.0 \
--style_norm_weight=0.0 --gt_data_weight=0.0 --cycle_loss_weight=10.0 --lr=0.0001 \n"; done


s=(1 2 3 4 5 6); g=(0 0 1 1 2 2); for i in ${!s[@]}; do \
XID=$(date +'%m%d-%H%M')_${i}; screen -X select ${s[i]}; screen -X title "${XID}@${g[i]}"; \
screen -X stuff "CUDA_VISIBLE_DEVICES=${g[i]} python train_disent_v1_2_16.py \
--gt_dataset_name=dshapes_split_color_vs_ori_size \
--output_dir=/scratch3/run/honest_disent/shapes/16_abl_no_guess_no_noise_no_swap_no_ssr/${XID}/ \
--load_size=64 --crop_size=64 --flip=false "; screen -X stuff " --guess_loss_weight=2.0 \
--identity_loss_weight=1.0 --defence_noise_sigma=0.0 --style_noise_sigma=0.0 \
--batch_size=16 --cycle_swap_weight=0.0 --style_swap_rec_weight=0.0 --style_rand_rec_weight=0.0 \
--style_norm_weight=0.0 --gt_data_weight=0.0 --cycle_loss_weight=10.0 \
--gen_lr=1e-4 --dis_lr=1e-4 --shuffle_supervised_pairs_buffer=0 \n"; done

% ---

export CUDA_VISIBLE_DEVICES=2
ROOT_FOLDER=/home/grad2/usmn/projects/better_cg/DomainIntersectionDifference/root_files
ROOT_FILE=synaction_v3_test
RUN_FOLDER=/scratch3/run/dom_diff_inter/synact_v3_run2/

python eval_batch.py --root ${ROOT_FOLDER}/${ROOT_FILE} --crop 256 \
--load ${RUN_FOLDER} --out ${RUN_FOLDER}/result_viz --num_display=9

python eval_batch.py --root ${ROOT_FOLDER}/${ROOT_FILE} --crop 256 \
--load ${RUN_FOLDER} --out ${RUN_FOLDER}/result_viz --num_display=9 --BtoA=1


% ---

from history

CUDA_VISIBLE_DEVICES=0 python train_disent_v1_2_16.py --gt_dataset_name=dshapes_split_color_vs_ori_size \
--output_dir=/scratch3/run/honest_disent/shapes/16_abl_sn2_sz03_no_guess_no_def_noise_no_swap_no_ssr/1114-2257_1/ \
--load_size=64 --crop_size=64 --flip=false  --guess_loss_weight=0.0 --identity_loss_weight=1.0 \
--defence_noise_sigma=0.0 --style_noise_sigma=0.3 --batch_size=16 --cycle_swap_weight=0.0 --style_swap_rec_weight=0.0 \
--style_rand_rec_weight=0.0 --style_norm_weight=2.0 --gt_data_weight=0.0 --cycle_loss_weight=10.0 \
--gen_lr=1e-4 --dis_lr=1e-4 --shuffle_supervised_pairs_buffer=0

% ---

s=(2); g=(0); for i in ${!s[@]}; do \
XID=$(date +'%m%d-%H%M')_${i}; screen -X select ${s[i]}; screen -X title "${XID}@${g[i]}"; \
screen -X stuff "CUDA_VISIBLE_DEVICES=${g[i]} python train_disent_v1_2_16.py \
--gt_dataset_name=dshapes_split_color_vs_ori_size \
--output_dir=/scratch3/run/honest_disent/new/shapes/16_rep_perfect_sn2_sz03_no_guess_no_def_noise_no_swap_no_ssr/${XID}/ \
--load_size=64 --crop_size=64 --flip=false "; screen -X stuff " --guess_loss_weight=0.0 --identity_loss_weight=1.0 \
--defence_noise_sigma=0.0 --style_noise_sigma=0.3 --batch_size=16 --cycle_swap_weight=0.0 --style_swap_rec_weight=0.0 \
--style_rand_rec_weight=0.0 --style_norm_weight=2.0 --gt_data_weight=0.0 --cycle_loss_weight=10.0 \
--gen_lr=1e-4 --dis_lr=1e-4 --shuffle_supervised_pairs_buffer=0 \n"; done

s=(1); g=(1); for i in ${!s[@]}; do \
XID=$(date +'%m%d-%H%M')_${i}; screen -X select ${s[i]}; screen -X title "${XID}@${g[i]}"; \
screen -X stuff "CUDA_VISIBLE_DEVICES=${g[i]} python train_disent_v1_2_16.py \
--gt_dataset_name=dshapes_fhue_shape_vs_ori_ohue \
--output_dir=/scratch3/run/honest_disent/new/shapes_fh/16_rep_perfect_sn2_sz03_no_guess_no_def_noise_no_swap_no_ssr/${XID}/ \
--load_size=64 --crop_size=64 --flip=false "; screen -X stuff " --guess_loss_weight=0.0 --identity_loss_weight=1.0 \
--defence_noise_sigma=0.0 --style_noise_sigma=0.3 --batch_size=16 --cycle_swap_weight=0.0 --style_swap_rec_weight=0.0 \
--style_rand_rec_weight=0.0 --style_norm_weight=2.0 --gt_data_weight=0.0 --cycle_loss_weight=10.0 \
--gen_lr=1e-4 --dis_lr=1e-4 --shuffle_supervised_pairs_buffer=0 \n"; done

s=(3); g=(2); for i in ${!s[@]}; do \
XID=$(date +'%m%d-%H%M')_${i}; screen -X select ${s[i]}; screen -X title "${XID}@${g[i]}"; \
screen -X stuff "CUDA_VISIBLE_DEVICES=${g[i]} python train_disent_v1_2_16.py \
--gt_dataset_name=dshapes_ohue_size_vs_shape_whue \
--output_dir=/scratch3/run/honest_disent/new/shapes_oh/16_rep_perfect_sn2_sz03_no_guess_no_def_noise_no_swap_no_ssr/${XID}/ \
--load_size=64 --crop_size=64 --flip=false "; screen -X stuff " --guess_loss_weight=0.0 --identity_loss_weight=1.0 \
--defence_noise_sigma=0.0 --style_noise_sigma=0.3 --batch_size=16 --cycle_swap_weight=0.0 --style_swap_rec_weight=0.0 \
--style_rand_rec_weight=0.0 --style_norm_weight=2.0 --gt_data_weight=0.0 --cycle_loss_weight=10.0 \
--gen_lr=1e-4 --dis_lr=1e-4 --shuffle_supervised_pairs_buffer=0 \n"; done

% ---

s=(1); g=(0); for i in ${!s[@]}; do \
XID=$(date +'%m%d-%H%M')_${i}; screen -X select ${s[i]}; screen -X title "${XID}@${g[i]}"; \
screen -X stuff "CUDA_VISIBLE_DEVICES=${g[i]} python train_disent_v1_2_16.py \
--gt_dataset_name=celeba_custom_split_sw2 \
--output_dir=/scratch3/run/honest_disent/new/celeba/16_rep_perfect_sn2_sz03_no_guess_no_def_noise_no_swap_no_ssr/${XID}/ \
--load_size=64 --crop_size=64 --flip=false "; screen -X stuff " --guess_loss_weight=0.0 --identity_loss_weight=1.0 \
--defence_noise_sigma=0.0 --style_noise_sigma=0.3 --batch_size=16 --cycle_swap_weight=0.0 --style_swap_rec_weight=0.0 \
--style_rand_rec_weight=0.0 --style_norm_weight=2.0 --gt_data_weight=0.0 --cycle_loss_weight=10.0 \
--gen_lr=1e-4 --dis_lr=1e-4 --shuffle_supervised_pairs_buffer=0 \n"; done


s=(2); g=(1); for i in ${!s[@]}; do \
XID=$(date +'%m%d-%H%M')_${i}; screen -X select ${s[i]}; screen -X title "${XID}@${g[i]}"; \
screen -X stuff "CUDA_VISIBLE_DEVICES=${g[i]} python train_disent_v1_2_16.py \
--gt_dataset_name=synaction_bg_vs_idt_v3 \
--output_dir=/scratch3/run/honest_disent/new/synact_v3/16_rep_perfect_sn2_sz03_no_guess_no_def_noise_no_swap_no_ssr/${XID}/ \
--load_size=64 --crop_size=64 --flip=false "; screen -X stuff " --guess_loss_weight=0.0 --identity_loss_weight=1.0 \
--defence_noise_sigma=0.0 --style_noise_sigma=0.3 --batch_size=16 --cycle_swap_weight=0.0 --style_swap_rec_weight=0.0 \
--style_rand_rec_weight=0.0 --style_norm_weight=2.0 --gt_data_weight=0.0 --cycle_loss_weight=10.0 \
--gen_lr=1e-4 --dis_lr=1e-4 --shuffle_supervised_pairs_buffer=0 \n"; done


% ---

s=(3); g=(0); for i in ${!s[@]}; do \
XID=$(date +'%m%d-%H%M')_${i}; screen -X select ${s[i]}; screen -X title "${XID}@${g[i]}"; \
screen -X stuff "CUDA_VISIBLE_DEVICES=${g[i]} python train_disent_v1_2_16.py \
--gt_dataset_name=celeba_custom_split_sw2 \
--output_dir=/scratch3/run/honest_disent/new/celeba/16_rep_perfect_sn2_sz03_no_guess_defn02_no_swap_no_ssr/${XID}/ \
--load_size=64 --crop_size=64 --flip=false "; screen -X stuff " --guess_loss_weight=0.0 --identity_loss_weight=1.0 \
--defence_noise_sigma=0.2 --style_noise_sigma=0.3 --batch_size=16 --cycle_swap_weight=0.0 --style_swap_rec_weight=0.0 \
--style_rand_rec_weight=0.0 --style_norm_weight=2.0 --gt_data_weight=0.0 --cycle_loss_weight=10.0 \
--gen_lr=1e-4 --dis_lr=1e-4 --shuffle_supervised_pairs_buffer=0 \n"; done


s=(2); g=(1); for i in ${!s[@]}; do \
XID=$(date +'%m%d-%H%M')_${i}; screen -X select ${s[i]}; screen -X title "${XID}@${g[i]}"; \
screen -X stuff "CUDA_VISIBLE_DEVICES=${g[i]} python train_disent_v1_2_16.py \
--gt_dataset_name=synaction_bg_vs_idt_v3 \
--output_dir=/scratch3/run/honest_disent/new/synact_v3/16_rep_perfect_sn2_sz03_no_guess_defn02_no_swap_no_ssr/${XID}/ \
--load_size=64 --crop_size=64 --flip=false "; screen -X stuff " --guess_loss_weight=0.0 --identity_loss_weight=1.0 \
--defence_noise_sigma=0.2 --style_noise_sigma=0.3 --batch_size=16 --cycle_swap_weight=0.0 --style_swap_rec_weight=0.0 \
--style_rand_rec_weight=0.0 --style_norm_weight=2.0 --gt_data_weight=0.0 --cycle_loss_weight=10.0 \
--gen_lr=1e-4 --dis_lr=1e-4 --shuffle_supervised_pairs_buffer=0 \n"; done

% ---

s=(2); g=(0); for i in ${!s[@]}; do \
XID=$(date +'%m%d-%H%M')_${i}; screen -X select ${s[i]}; screen -X title "${XID}@${g[i]}"; \
screen -X stuff "CUDA_VISIBLE_DEVICES=${g[i]} python train_disent_v1_2_17.py \
--gt_dataset_name=dshapes_split_color_vs_ori_size \
--output_dir=/scratch3/run/honest_disent/new/shapes/17_rep_perfect_sn2_sz03_no_guess_no_def_noise_no_swap_no_ssr/${XID}/ \
--load_size=64 --crop_size=64 --flip=false "; screen -X stuff " --guess_loss_weight=0.0 --identity_loss_weight=1.0 \
--defence_noise_sigma=0.0 --style_noise_sigma=0.3 --batch_size=16 --cycle_swap_weight=0.0 --style_swap_rec_weight=0.0 \
--style_rand_rec_weight=0.0 --style_norm_weight=2.0 --gt_data_weight=0.0 --cycle_loss_weight=10.0 \
--gen_lr=1e-4 --dis_lr=1e-4 --shuffle_supervised_pairs_buffer=0 --log_hidden_metrics_every=100 \n"; done

% ---

s=(2); g=(1); for i in ${!s[@]}; do \
XID=$(date +'%m%d-%H%M')_${i}; screen -X select ${s[i]}; screen -X title "${XID}@${g[i]}"; \
screen -X stuff "CUDA_VISIBLE_DEVICES=${g[i]} python train_disent_v1_2_17.py \
--gt_dataset_name=dshapes_split_color_vs_ori_size \
--output_dir=/scratch3/run/honest_disent/new/shapes/17_rep_perfect_sn2_sz03_no_guess_no_def_noise_no_swap_no_ssr/${XID}/ \
--load_size=64 --crop_size=64 --flip=false "; screen -X stuff " --guess_loss_weight=0.0 --identity_loss_weight=1.0 \
--defence_noise_sigma=0.0 --style_noise_sigma=0.3 --batch_size=16 --cycle_swap_weight=0.0 --style_swap_rec_weight=0.0 \
--style_rand_rec_weight=0.0 --style_norm_weight=2.0 --gt_data_weight=0.0 --cycle_loss_weight=10.0 \
--gen_lr=1e-4 --dis_lr=1e-4 --shuffle_supervised_pairs_buffer=0 \n"; done


s=(3); g=(0); for i in ${!s[@]}; do \
XID=$(date +'%m%d-%H%M')_${i}; screen -X select ${s[i]}; screen -X title "${XID}@${g[i]}"; \
screen -X stuff "CUDA_VISIBLE_DEVICES=${g[i]} python train_disent_v1_2_17.py \
--gt_dataset_name=dshapes_ohue_size_vs_shape_whue \
--output_dir=/scratch3/run/honest_disent/new/shapes_oh/17_sn1_sz01_no_guess_no_def_noise_no_swap_no_ssr/${XID}/ \
--load_size=64 --crop_size=64 --flip=false "; screen -X stuff " --guess_loss_weight=0.0 --identity_loss_weight=1.0 \
--defence_noise_sigma=0.0 --style_noise_sigma=0.1 --batch_size=16 --cycle_swap_weight=0.0 --style_swap_rec_weight=0.0 \
--style_rand_rec_weight=0.0 --style_norm_weight=1.0 --gt_data_weight=0.0 --cycle_loss_weight=10.0 \
--gen_lr=1e-4 --dis_lr=1e-4 --shuffle_supervised_pairs_buffer=0 \n"; done


s=(1); g=(2); for i in ${!s[@]}; do \
XID=$(date +'%m%d-%H%M')_${i}; screen -X select ${s[i]}; screen -X title "${XID}@${g[i]}"; \
screen -X stuff "CUDA_VISIBLE_DEVICES=${g[i]} python train_disent_v1_2_17.py \
--gt_dataset_name=dshapes_fhue_shape_vs_ori_ohue \
--output_dir=/scratch3/run/honest_disent/new/shapes_fh/17_sn1_sz01_no_guess_no_def_noise_no_swap_no_ssr/${XID}/ \
--load_size=64 --crop_size=64 --flip=false "; screen -X stuff " --guess_loss_weight=0.0 --identity_loss_weight=1.0 \
--defence_noise_sigma=0.0 --style_noise_sigma=0.1 --batch_size=16 --cycle_swap_weight=0.0 --style_swap_rec_weight=0.0 \
--style_rand_rec_weight=0.0 --style_norm_weight=1.0 --gt_data_weight=0.0 --cycle_loss_weight=10.0 \
--gen_lr=1e-4 --dis_lr=1e-4 --shuffle_supervised_pairs_buffer=0 \n"; done

% ---

s=(1); g=(0); for i in ${!s[@]}; do \
XID=$(date +'%m%d-%H%M')_${i}; screen -X select ${s[i]}; screen -X title "${XID}@${g[i]}"; \
screen -X stuff "CUDA_VISIBLE_DEVICES=${g[i]} python train_disent_v1_2_17.py \
--gt_dataset_name=celeba_custom_split_sw2 \
--output_dir=/scratch3/run/honest_disent/new/celeba/17_as_cyclegan/${XID}/ \
--load_size=64 --crop_size=64 --flip=false "; screen -X stuff " --guess_loss_weight=0.0 --identity_loss_weight=1.0 \
--defence_noise_sigma=0.0 --style_noise_sigma=10.0 --batch_size=16 --cycle_swap_weight=0.0 --style_swap_rec_weight=0.0 \
--style_rand_rec_weight=0.0 --style_norm_weight=10.0 --gt_data_weight=0.0 --cycle_loss_weight=10.0 \
--gen_lr=1e-4 --dis_lr=1e-4 --shuffle_supervised_pairs_buffer=0 \n"; done

% ---

s=(2); g=(1); for i in ${!s[@]}; do \
XID=$(date +'%m%d-%H%M')_${i}; screen -X select ${s[i]}; screen -X title "${XID}@${g[i]}"; \
screen -X stuff "CUDA_VISIBLE_DEVICES=${g[i]} python train_disent_v1_2_17.py \
--gt_dataset_name=celeba_custom_split_sw2 \
--output_dir=/scratch3/run/honest_disent/new/celeba/17_sn2_sz03_no_guess_defn02_no_swap_no_ssr/${XID}/ \
--load_size=64 --crop_size=64 --flip=false "; screen -X stuff " --guess_loss_weight=0.0 --identity_loss_weight=1.0 \
--defence_noise_sigma=0.2 --style_noise_sigma=0.3 --batch_size=16 --cycle_swap_weight=0.0 --style_swap_rec_weight=0.0 \
--style_rand_rec_weight=0.0 --style_norm_weight=2.0 --gt_data_weight=0.0 --cycle_loss_weight=10.0 \
--gen_lr=1e-4 --dis_lr=1e-4 --shuffle_supervised_pairs_buffer=0 \n"; done

% ---

s=(1); g=(2); for i in ${!s[@]}; do \
XID=$(date +'%m%d-%H%M')_${i}; screen -X select ${s[i]}; screen -X title "${XID}@${g[i]}"; \
screen -X stuff "CUDA_VISIBLE_DEVICES=${g[i]} python train_disent_v1_2_17.py \
--gt_dataset_name=dshapes_fhue_shape_vs_ori_ohue \
--output_dir=/scratch3/run/honest_disent/new/shapes_fh/17_sn1_sz01_no_guess_defn1_no_swap_no_ssr/${XID}/ \
--load_size=64 --crop_size=64 --flip=false "; screen -X stuff " --guess_loss_weight=0.0 --identity_loss_weight=1.0 \
--defence_noise_sigma=1.0 --style_noise_sigma=0.1 --batch_size=16 --cycle_swap_weight=0.0 --style_swap_rec_weight=0.0 \
--style_rand_rec_weight=0.0 --style_norm_weight=1.0 --gt_data_weight=0.0 --cycle_loss_weight=10.0 \
--gen_lr=1e-4 --dis_lr=1e-4 --shuffle_supervised_pairs_buffer=0 \n"; done

% ---

s=(2); g=(1); for i in ${!s[@]}; do \
XID=$(date +'%m%d-%H%M')_${i}; screen -X select ${s[i]}; screen -X title "${XID}@${g[i]}"; \
screen -X stuff "CUDA_VISIBLE_DEVICES=${g[i]} python train_disent_v1_2_17.py \
--gt_dataset_name=dshapes_fhue_shape_vs_ori_ohue \
--output_dir=/scratch3/run/honest_disent/new/shapes_fh/17_sn1_sz01_no_guess_defn01_no_swap_no_ssr/${XID}/ \
--load_size=64 --crop_size=64 --flip=false "; screen -X stuff " --guess_loss_weight=0.0 --identity_loss_weight=1.0 \
--defence_noise_sigma=0.1 --style_noise_sigma=0.1 --batch_size=16 --cycle_swap_weight=0.0 --style_swap_rec_weight=0.0 \
--style_rand_rec_weight=0.0 --style_norm_weight=1.0 --gt_data_weight=0.0 --cycle_loss_weight=10.0 \
--gen_lr=1e-4 --dis_lr=1e-4 --shuffle_supervised_pairs_buffer=0 \n"; done

% ---

mkdir /scratch3/run/honest_disent/fake_dirs/$(date +'%m%d-%H%M')/

% ---

s=(3); g=(0); for i in ${!s[@]}; do \
XID=$(date +'%m%d-%H%M')_${i}; screen -X select ${s[i]}; screen -X title "${XID}@${g[i]}"; \
screen -X stuff "CUDA_VISIBLE_DEVICES=${g[i]} python train_disent_v1_2_17.py \
--gt_dataset_name=dshapes_fhue_shape_vs_ori_ohue \
--output_dir=/scratch3/run/honest_disent/new/shapes_fh/17_sn05_sz01_no_guess_defn01_no_swap_no_ssr/${XID}/ \
--load_size=64 --crop_size=64 --flip=false "; screen -X stuff " --guess_loss_weight=0.0 --identity_loss_weight=1.0 \
--defence_noise_sigma=0.1 --style_noise_sigma=0.1 --batch_size=16 --cycle_swap_weight=0.0 --style_swap_rec_weight=0.0 \
--style_rand_rec_weight=0.0 --style_norm_weight=0.5 --gt_data_weight=0.0 --cycle_loss_weight=10.0 \
--gen_lr=1e-4 --dis_lr=1e-4 --shuffle_supervised_pairs_buffer=0 \n"; done

% ---

s=(1); g=(2); for i in ${!s[@]}; do \
XID=$(date +'%m%d-%H%M')_${i}; screen -X select ${s[i]}; screen -X title "${XID}@${g[i]}"; \
screen -X stuff "CUDA_VISIBLE_DEVICES=${g[i]} python train_disent_v1_2_17.py \
--gt_dataset_name=dshapes_fhue_shape_vs_ori_ohue \
--output_dir=/scratch3/run/honest_disent/new/shapes_fh/17_sn1_sz01_no_guess_defn5_no_swap_no_ssr/${XID}/ \
--load_size=64 --crop_size=64 --flip=false "; screen -X stuff " --guess_loss_weight=0.0 --identity_loss_weight=1.0 \
--defence_noise_sigma=5.0 --style_noise_sigma=0.1 --batch_size=16 --cycle_swap_weight=0.0 --style_swap_rec_weight=0.0 \
--style_rand_rec_weight=0.0 --style_norm_weight=1.0 --gt_data_weight=0.0 --cycle_loss_weight=10.0 \
--gen_lr=1e-4 --dis_lr=1e-4 --shuffle_supervised_pairs_buffer=0 \n"; done

% ---

s=(1); g=(0); for i in ${!s[@]}; do \
XID=$(date +'%m%d-%H%M')_${i}; screen -X select ${s[i]}; screen -X title "${XID}@${g[i]}"; \
screen -X stuff "CUDA_VISIBLE_DEVICES=${g[i]} python train_disent_v1_2_17.py \
--gt_dataset_name=dshapes_fhue_shape_vs_ori_ohue \
--output_dir=/scratch3/run/honest_disent/new/shapes_fh/17_sn05_sz01_no_guess_defn1_no_swap_no_ssr/${XID}/ \
--load_size=64 --crop_size=64 --flip=false "; screen -X stuff " --guess_loss_weight=0.0 --identity_loss_weight=1.0 \
--defence_noise_sigma=1.0 --style_noise_sigma=0.1 --batch_size=16 --cycle_swap_weight=0.0 --style_swap_rec_weight=0.0 \
--style_rand_rec_weight=0.0 --style_norm_weight=0.5 --gt_data_weight=0.0 --cycle_loss_weight=10.0 \
--gen_lr=1e-4 --dis_lr=1e-4 --shuffle_supervised_pairs_buffer=0 \n"; done

s=(2); g=(1); for i in ${!s[@]}; do \
XID=$(date +'%m%d-%H%M')_${i}; screen -X select ${s[i]}; screen -X title "${XID}@${g[i]}"; \
screen -X stuff "CUDA_VISIBLE_DEVICES=${g[i]} python train_disent_v1_2_17.py \
--gt_dataset_name=dshapes_fhue_shape_vs_ori_ohue \
--output_dir=/scratch3/run/honest_disent/new/shapes_fh/17_sn05_sz01_no_guess_defn2_no_swap_no_ssr/${XID}/ \
--load_size=64 --crop_size=64 --flip=false "; screen -X stuff " --guess_loss_weight=0.0 --identity_loss_weight=1.0 \
--defence_noise_sigma=2.0 --style_noise_sigma=0.1 --batch_size=16 --cycle_swap_weight=0.0 --style_swap_rec_weight=0.0 \
--style_rand_rec_weight=0.0 --style_norm_weight=0.5 --gt_data_weight=0.0 --cycle_loss_weight=10.0 \
--gen_lr=1e-4 --dis_lr=1e-4 --shuffle_supervised_pairs_buffer=0 \n"; done

s=(3); g=(2); for i in ${!s[@]}; do \
XID=$(date +'%m%d-%H%M')_${i}; screen -X select ${s[i]}; screen -X title "${XID}@${g[i]}"; \
screen -X stuff "CUDA_VISIBLE_DEVICES=${g[i]} python train_disent_v1_2_17.py \
--gt_dataset_name=dshapes_fhue_shape_vs_ori_ohue \
--output_dir=/scratch3/run/honest_disent/new/shapes_fh/17_sn05_sz01_no_guess_defn3_no_swap_no_ssr/${XID}/ \
--load_size=64 --crop_size=64 --flip=false "; screen -X stuff " --guess_loss_weight=0.0 --identity_loss_weight=1.0 \
--defence_noise_sigma=3.0 --style_noise_sigma=0.1 --batch_size=16 --cycle_swap_weight=0.0 --style_swap_rec_weight=0.0 \
--style_rand_rec_weight=0.0 --style_norm_weight=0.5 --gt_data_weight=0.0 --cycle_loss_weight=10.0 \
--gen_lr=1e-4 --dis_lr=1e-4 --shuffle_supervised_pairs_buffer=0 \n"; done

% ---

s=(1); g=(0); for i in ${!s[@]}; do \
XID=$(date +'%m%d-%H%M')_${i}; screen -X select ${s[i]}; screen -X title "${XID}@${g[i]}"; \
screen -X stuff "CUDA_VISIBLE_DEVICES=${g[i]} python train_disent_v1_2_17.py \
--gt_dataset_name=dshapes_fhue_shape_vs_ori_ohue \
--output_dir=/scratch3/run/honest_disent/new/shapes_fh/17_sn05_sz01_no_guess_no_def_noise_no_swap_no_ssr/${XID}/ \
--load_size=64 --crop_size=64 --flip=false "; screen -X stuff " --guess_loss_weight=0.0 --identity_loss_weight=1.0 \
--defence_noise_sigma=0.0 --style_noise_sigma=0.1 --batch_size=16 --cycle_swap_weight=0.0 --style_swap_rec_weight=0.0 \
--style_rand_rec_weight=0.0 --style_norm_weight=0.5 --gt_data_weight=0.0 --cycle_loss_weight=10.0 \
--gen_lr=1e-4 --dis_lr=1e-4 --shuffle_supervised_pairs_buffer=0 \n"; done

s=(2); g=(1); for i in ${!s[@]}; do \
XID=$(date +'%m%d-%H%M')_${i}; screen -X select ${s[i]}; screen -X title "${XID}@${g[i]}"; \
screen -X stuff "CUDA_VISIBLE_DEVICES=${g[i]} python train_disent_v1_2_17.py \
--gt_dataset_name=dshapes_fhue_shape_vs_ori_ohue \
--output_dir=/scratch3/run/honest_disent/new/shapes_fh/17_sn03_sz01_no_guess_no_def_noise_no_swap_no_ssr/${XID}/ \
--load_size=64 --crop_size=64 --flip=false "; screen -X stuff " --guess_loss_weight=0.0 --identity_loss_weight=1.0 \
--defence_noise_sigma=0.0 --style_noise_sigma=0.1 --batch_size=16 --cycle_swap_weight=0.0 --style_swap_rec_weight=0.0 \
--style_rand_rec_weight=0.0 --style_norm_weight=0.3 --gt_data_weight=0.0 --cycle_loss_weight=10.0 \
--gen_lr=1e-4 --dis_lr=1e-4 --shuffle_supervised_pairs_buffer=0 \n"; done

s=(3); g=(2); for i in ${!s[@]}; do \
XID=$(date +'%m%d-%H%M')_${i}; screen -X select ${s[i]}; screen -X title "${XID}@${g[i]}"; \
screen -X stuff "CUDA_VISIBLE_DEVICES=${g[i]} python train_disent_v1_2_17.py \
--gt_dataset_name=dshapes_fhue_shape_vs_ori_ohue \
--output_dir=/scratch3/run/honest_disent/new/shapes_fh/17_sn01_sz01_no_guess_no_def_noise_no_swap_no_ssr/${XID}/ \
--load_size=64 --crop_size=64 --flip=false "; screen -X stuff " --guess_loss_weight=0.0 --identity_loss_weight=1.0 \
--defence_noise_sigma=0.0 --style_noise_sigma=0.1 --batch_size=16 --cycle_swap_weight=0.0 --style_swap_rec_weight=0.0 \
--style_rand_rec_weight=0.0 --style_norm_weight=0.1 --gt_data_weight=0.0 --cycle_loss_weight=10.0 \
--gen_lr=1e-4 --dis_lr=1e-4 --shuffle_supervised_pairs_buffer=0 \n"; done


s=(1 2 3); g=(0 1 2); p=(0.02 0.05 0.1); n=(002 005 01); for i in ${!s[@]}; do \
XID=$(date +'%m%d-%H%M')_${i}; screen -X select ${s[i]}; screen -X title "${XID}@${g[i]}"; \
screen -X stuff "CUDA_VISIBLE_DEVICES=${g[i]} python train_disent_v1_2_17.py \
--gt_dataset_name=dshapes_fhue_shape_vs_ori_ohue \
--output_dir=/scratch3/run/honest_disent/new/shapes_fh/17_sn03_sz01_no_guess_dn${n[i]}_no_swap_no_ssr/${XID}/ \
--load_size=64 --crop_size=64 --flip=false "; screen -X stuff " --guess_loss_weight=0.0 --identity_loss_weight=1.0 \
--defence_noise_sigma=${p[i]} --style_noise_sigma=0.1 --batch_size=16 --cycle_swap_weight=0.0 --style_swap_rec_weight=0.0 \
--style_rand_rec_weight=0.0 --style_norm_weight=0.3 --gt_data_weight=0.0 --cycle_loss_weight=10.0 \
--gen_lr=1e-4 --dis_lr=1e-4 --shuffle_supervised_pairs_buffer=0 \n"; done

XID=$(date +'%m%d-%H%M')_0; python train_disent_v1_2_17.py \
--gt_main_dataset_root='/projectnb/ivc-ml/usmn/data/guess_disent/' \
--gt_main_attr_clf_model_root='/projectnb/ivc-ml/usmn/data/attr_models/' \
--gt_dataset_name=dshapes_fhue_shape_vs_ori_ohue \
--output_dir=/projectnb/ivc-ml/usmn/run/honest_disent/shapes_fh/17_sn03_sz01_guess005_dn01_no_swap_no_ssr/${XID}/ \
--load_size=64 --crop_size=64 --flip=false --guess_loss_weight=0.05 --identity_loss_weight=1.0 \
--defence_noise_sigma=0.1 --style_noise_sigma=0.1 --batch_size=16 --cycle_swap_weight=0.0 --style_swap_rec_weight=0.0 \
--style_rand_rec_weight=0.0 --style_norm_weight=0.3 --gt_data_weight=0.0 --cycle_loss_weight=10.0 \
--gen_lr=1e-4 --dis_lr=1e-4 --shuffle_supervised_pairs_buffer=0

s=(1 2 3); g=(0 1 2); p=(0.02 0.05 0.1); n=(002 005 01); for i in ${!s[@]}; do \
XID=$(date +'%m%d-%H%M')_${i}; screen -X select ${s[i]}; screen -X title "${XID}@${g[i]}"; \
screen -X stuff "CUDA_VISIBLE_DEVICES=${g[i]} python -m pdb -c cont train_disent_v1_2_17.py \
--gt_dataset_name=dshapes_fhue_shape_vs_ori_ohue \
--output_dir=/scratch3/run/honest_disent/new/shapes_fh/17_sn03_sz01_gs${n[i]}_dn01_no_swap_no_ssr/${XID}/ \
--load_size=64 --crop_size=64 --flip=false "; screen -X stuff " --guess_loss_weight=${p[i]} --identity_loss_weight=1.0 \
--defence_noise_sigma=0.1 --style_noise_sigma=0.1 --batch_size=16 --cycle_swap_weight=0.0 --style_swap_rec_weight=0.0 \
--style_rand_rec_weight=0.0 --style_norm_weight=0.3 --gt_data_weight=0.0 --cycle_loss_weight=10.0 \
--gen_lr=1e-4 --dis_lr=1e-4 --shuffle_supervised_pairs_buffer=0 \n"; done

XID=$(date +'%m%d-%H%M')_${i}; python train_disent_v1_2_17.py \
--gt_main_dataset_root='/projectnb/ivc-ml/usmn/data/guess_disent/' \
--gt_main_attr_clf_model_root='/projectnb/ivc-ml/usmn/data/attr_models/' \
--gt_dataset_name=dshapes_fhue_shape_vs_ori_ohue \
--output_dir=/projectnb/ivc-ml/usmn/run/honest_disent/shapes_fh/17_sn03_sz01_gs005_al_tr_gs_dn01_no_swap_no_ssr/${XID}/ \
--load_size=64 --crop_size=64 --flip=false --guess_loss_weight=0.05 --identity_loss_weight=1.0 \
--defence_noise_sigma=0.1 --style_noise_sigma=0.1 --batch_size=16 --cycle_swap_weight=0.0 --style_swap_rec_weight=0.0 \
--style_rand_rec_weight=0.0 --style_norm_weight=0.3 --gt_data_weight=0.0 --cycle_loss_weight=10.0 \
--gen_lr=1e-4 --dis_lr=1e-4 --shuffle_supervised_pairs_buffer=0 --always_train_guess_disc=true

# TODO: repeat same with --always_train_guess_disc=true

module load miniconda
conda activate py38tf24
cd /net/cs-nfs/home/grad2/usmn/projects/better_cg/CycleGAN-Tensorflow-2


export OMP_NUM_THREADS=3
export TF_NUM_INTEROP_THREADS=3
export TF_NUM_INTRAOP_THREADS=1


XID=$(date +'%m%d-%H%M'); qsub -j y -m ea -N h_${XID} -l gpus=1 -pe omp 3 \
/projectnb/ivc-ml/usmn/util/launch.sh python train_disent_v1_2_17.py \
--gt_main_dataset_root='/projectnb/ivc-ml/usmn/data/guess_disent/' \
--gt_main_attr_clf_model_root='/projectnb/ivc-ml/usmn/data/attr_models/' \
--gt_dataset_name=dshapes_fhue_shape_vs_ori_ohue \
--output_dir=/projectnb/ivc-ml/usmn/run/honest_disent/shapes_fh/17_sn03_sz01_gs005_al_tr_gs_dn01_no_swap_no_ssr/${XID}/ \
--load_size=64 --crop_size=64 --flip=false --guess_loss_weight=0.05 --identity_loss_weight=1.0 --defence_noise_sigma=0.1 \
--style_noise_sigma=0.1 --batch_size=16 --cycle_swap_weight=0.0 --style_swap_rec_weight=0.0 --style_rand_rec_weight=0.0 \
--style_norm_weight=0.3 --gt_data_weight=0.0 --cycle_loss_weight=10.0 --gen_lr=1e-4 --dis_lr=1e-4 \
--shuffle_supervised_pairs_buffer=0 --always_train_guess_disc=true


rsync -avzh --info=progress2 --exclude='*hidden_cache.data-00000-of-00001' \
/projectnb/ivc-ml/usmn/run/honest_disent/ emmy_csa1:/scratch3/run/honest_disent/remote/

while true; do date; \
rsync -avzh --inplace --info=progress2 --include='events*' --include='*/' --exclude='*' \
/projectnb/ivc-ml/usmn/run/honest_disent/ emmy_csa1:/scratch3/run/honest_disent/remote/; \
sleep $((10*60)); done


% ---

s=(1 2 3); g=(0 1 2); p=(0.05 0.05 0.05); n=(005 005 005); for i in ${!s[@]}; do \
XID=$(date +'%m%d-%H%M')_${i}; screen -X select ${s[i]}; screen -X title "${XID}@${g[i]}"; \
screen -X stuff "CUDA_VISIBLE_DEVICES=${g[i]} python -m pdb -c cont train_disent_v1_2_17.py \
--gt_dataset_name=dshapes_fhue_shape_vs_ori_ohue \
--output_dir=/scratch3/run/honest_disent/new/shapes_fh/17_sn03_sz01_gs${n[i]}_dn01_no_swap_no_ssr/${XID}/ \
--load_size=64 --crop_size=64 --flip=false "; screen -X stuff " --guess_loss_weight=${p[i]} --identity_loss_weight=1.0 \
--defence_noise_sigma=0.1 --style_noise_sigma=0.1 --batch_size=16 --cycle_swap_weight=0.0 --style_swap_rec_weight=0.0 \
--style_rand_rec_weight=0.0 --style_norm_weight=0.3 --gt_data_weight=0.0 --cycle_loss_weight=10.0 \
--gen_lr=1e-4 --dis_lr=1e-4 --shuffle_supervised_pairs_buffer=0 \n"; done

% ---

for i in 1 2 3; do \
EXP_ROOT=/projectnb/ivc-ml/usmn/run/honest_disent; \
EXP=shapes_fh/17_sn03_sz01_gs005_dn01_shuf; XID=$(date +'%m%d-%H%M')_${i}; 
OUTPUT=${EXP_ROOT}/${EXP}/${XID}/; echo ${OUTPUT}; mkdir -p ${OUTPUT}; \
qsub -j y -m ea -N ${EXP/\//_}_${XID} -o ${OUTPUT}/log.txt \
-v OMP_NUM_THREADS=3,TF_NUM_INTEROP_THREADS=3,TF_NUM_INTRAOP_THREADS=1 \
-l gpus=1 -pe omp 3 ~/launch.sh python train_disent_v1_2_17.py \
--gt_main_dataset_root='/projectnb/ivc-ml/usmn/data/guess_disent/' \
--gt_main_attr_clf_model_root='/projectnb/ivc-ml/usmn/data/attr_models/' \
--gt_dataset_name=dshapes_fhue_shape_vs_ori_ohue --output_dir=${OUTPUT} \
--load_size=64 --crop_size=64 --flip=false --guess_loss_weight=0.05 --identity_loss_weight=1.0 \
--defence_noise_sigma=0.1 --style_noise_sigma=0.1 --batch_size=16 --cycle_swap_weight=0.0 --style_swap_rec_weight=0.0 \
--style_rand_rec_weight=0.0 --style_norm_weight=0.3 --gt_data_weight=0.0 --cycle_loss_weight=10.0 \
--gen_lr=1e-4 --dis_lr=1e-4 --shuffle_supervised_pairs_buffer=1 \
; done

% ---

for i in 1 2 3; do \
EXP_ROOT=/projectnb/ivc-ml/usmn/run/honest_disent; \
EXP=shapes_fh/17_sn05_sz01_gs005_dn01_shuf; XID=$(date +'%m%d-%H%M')_${i}; 
OUTPUT=${EXP_ROOT}/${EXP}/${XID}/; echo ${OUTPUT}; mkdir -p ${OUTPUT}; \
qsub -j y -m ea -N ${EXP/\//_}_${XID} -o ${OUTPUT}/log.txt \
-v OMP_NUM_THREADS=3,TF_NUM_INTEROP_THREADS=3,TF_NUM_INTRAOP_THREADS=1 \
-l gpus=1 -pe omp 3 ~/launch.sh python train_disent_v1_2_17.py \
--gt_main_dataset_root='/projectnb/ivc-ml/usmn/data/guess_disent/' \
--gt_main_attr_clf_model_root='/projectnb/ivc-ml/usmn/data/attr_models/' \
--gt_dataset_name=dshapes_fhue_shape_vs_ori_ohue --output_dir=${OUTPUT} \
--load_size=64 --crop_size=64 --flip=false --guess_loss_weight=0.05 --identity_loss_weight=1.0 \
--defence_noise_sigma=0.1 --style_noise_sigma=0.1 --batch_size=16 --cycle_swap_weight=0.0 --style_swap_rec_weight=0.0 \
--style_rand_rec_weight=0.0 --style_norm_weight=0.5 --gt_data_weight=0.0 --cycle_loss_weight=10.0 \
--gen_lr=1e-4 --dis_lr=1e-4 --shuffle_supervised_pairs_buffer=1 \
; done

% ---

for i in 1 2 3; do \
EXP=shapes_fh/17_sn1_sz01_gs005_dn01_shuf; \
EXP_ROOT=/projectnb/ivc-ml/usmn/run/honest_disent; XID=$(date +'%m%d-%H%M')_${i}; \ 
OUTPUT=${EXP_ROOT}/${EXP}/${XID}/; echo ${OUTPUT}; mkdir -p ${OUTPUT}; \
qsub -j y -m ea -N ${EXP/\//_}_${XID} -o ${OUTPUT}/log.txt \
-v OMP_NUM_THREADS=3,TF_NUM_INTEROP_THREADS=3,TF_NUM_INTRAOP_THREADS=1 \
-l gpus=1 -pe omp 3 ~/launch.sh python train_disent_v1_2_17.py \
--gt_main_dataset_root='/projectnb/ivc-ml/usmn/data/guess_disent/' \
--gt_main_attr_clf_model_root='/projectnb/ivc-ml/usmn/data/attr_models/' \
--gt_dataset_name=dshapes_fhue_shape_vs_ori_ohue --output_dir=${OUTPUT} \
--load_size=64 --crop_size=64 --flip=false --guess_loss_weight=0.05 --identity_loss_weight=1.0 \
--defence_noise_sigma=0.1 --style_noise_sigma=0.1 --batch_size=16 --cycle_swap_weight=0.0 --style_swap_rec_weight=0.0 \
--style_rand_rec_weight=0.0 --style_norm_weight=1.0 --gt_data_weight=0.0 --cycle_loss_weight=10.0 \
--gen_lr=1e-4 --dis_lr=1e-4 --shuffle_supervised_pairs_buffer=1 \
; done

% ---


for i in 1 2 3; do \
EXP=shapes_fh/17_sn07_sz01_gs005_dn01_shuf; \
EXP_ROOT=/projectnb/ivc-ml/usmn/run/honest_disent; XID=$(date +'%m%d-%H%M')_${i}; \ 
OUTPUT=${EXP_ROOT}/${EXP}/${XID}/; echo ${OUTPUT}; mkdir -p ${OUTPUT}; \
qsub -j y -m ea -N ${EXP/\//_}_${XID} -o ${OUTPUT}/log.txt \
-v OMP_NUM_THREADS=3,TF_NUM_INTEROP_THREADS=3,TF_NUM_INTRAOP_THREADS=1 \
-l gpus=1 -pe omp 3 ~/launch.sh python train_disent_v1_2_17.py \
--gt_main_dataset_root='/projectnb/ivc-ml/usmn/data/guess_disent/' \
--gt_main_attr_clf_model_root='/projectnb/ivc-ml/usmn/data/attr_models/' \
--gt_dataset_name=dshapes_fhue_shape_vs_ori_ohue --output_dir=${OUTPUT} \
--load_size=64 --crop_size=64 --flip=false --guess_loss_weight=0.05 --identity_loss_weight=1.0 \
--defence_noise_sigma=0.1 --style_noise_sigma=0.1 --batch_size=16 --cycle_swap_weight=0.0 --style_swap_rec_weight=0.0 \
--style_rand_rec_weight=0.0 --style_norm_weight=0.7 --gt_data_weight=0.0 --cycle_loss_weight=10.0 \
--gen_lr=1e-4 --dis_lr=1e-4 --shuffle_supervised_pairs_buffer=1 \
; done

% ---

for i in 1 2 3; do \
EXP=synact_v3/17_sn07_sz01_gs005_dn01_shuf; \
EXP_ROOT=/projectnb/ivc-ml/usmn/run/honest_disent; XID=$(date +'%m%d-%H%M')_${i}; \ 
OUTPUT=${EXP_ROOT}/${EXP}/${XID}/; echo ${OUTPUT}; mkdir -p ${OUTPUT}; \
qsub -j y -m ea -N ${EXP/\//_}_${XID} -o ${OUTPUT}/log.txt \
-v OMP_NUM_THREADS=3,TF_NUM_INTEROP_THREADS=3,TF_NUM_INTRAOP_THREADS=1 \
-l gpus=1 -pe omp 3 ~/launch.sh python train_disent_v1_2_17.py \
--gt_main_dataset_root='/projectnb/ivc-ml/usmn/data/guess_disent/' \
--gt_main_attr_clf_model_root='/projectnb/ivc-ml/usmn/data/attr_models/' \
--gt_dataset_name=synaction_bg_vs_idt_v3 --output_dir=${OUTPUT} \
--load_size=64 --crop_size=64 --flip=false --guess_loss_weight=0.05 --identity_loss_weight=1.0 \
--defence_noise_sigma=0.1 --style_noise_sigma=0.1 --batch_size=16 --cycle_swap_weight=0.0 --style_swap_rec_weight=0.0 \
--style_rand_rec_weight=0.0 --style_norm_weight=0.7 --gt_data_weight=0.0 --cycle_loss_weight=10.0 \
--gen_lr=1e-4 --dis_lr=1e-4 --shuffle_supervised_pairs_buffer=1 --log_hidden_metrics_every=10000 \
; done

% ---

for i in 1 2 3; do \
EXP=synact_v3/17_sn07_sz01_gs01_dn01_shuf; \
EXP_ROOT=/projectnb/ivc-ml/usmn/run/honest_disent; XID=$(date +'%m%d-%H%M')_${i}; \
OUTPUT=${EXP_ROOT}/${EXP}/${XID}/; echo ${OUTPUT}; mkdir -p ${OUTPUT}; \
qsub -j y -m ea -N ${EXP/\//_}_${XID} -o ${OUTPUT}/log.txt \
-v OMP_NUM_THREADS=3,TF_NUM_INTEROP_THREADS=3,TF_NUM_INTRAOP_THREADS=1 \
-l gpus=1 -pe omp 3 ~/launch.sh python train_disent_v1_2_17.py \
--gt_main_dataset_root='/projectnb/ivc-ml/usmn/data/guess_disent/' \
--gt_main_attr_clf_model_root='/projectnb/ivc-ml/usmn/data/attr_models/' \
--gt_dataset_name=synaction_bg_vs_idt_v3 --output_dir=${OUTPUT} \
--load_size=64 --crop_size=64 --flip=false --guess_loss_weight=0.1 --identity_loss_weight=1.0 \
--defence_noise_sigma=0.1 --style_noise_sigma=0.1 --batch_size=16 --cycle_swap_weight=0.0 --style_swap_rec_weight=0.0 \
--style_rand_rec_weight=0.0 --style_norm_weight=0.7 --gt_data_weight=0.0 --cycle_loss_weight=10.0 \
--gen_lr=1e-4 --dis_lr=1e-4 --shuffle_supervised_pairs_buffer=1 --log_hidden_metrics_every=10000 \
; done

% ---

for i in 1 2 3; do \
EXP=shapes_fh/17_sn07_sz02_gs005_dn01_shuf; \
EXP_ROOT=/projectnb/ivc-ml/usmn/run/honest_disent; XID=$(date +'%m%d-%H%M')_${i}; \
OUTPUT=${EXP_ROOT}/${EXP}/${XID}/; echo ${OUTPUT}; mkdir -p ${OUTPUT}; \
qsub -j y -m ea -N ${EXP/\//_}_${XID} -o ${OUTPUT}/log.txt \
-v OMP_NUM_THREADS=3,TF_NUM_INTEROP_THREADS=3,TF_NUM_INTRAOP_THREADS=1 \
-l gpus=1 -pe omp 3 ~/launch.sh python train_disent_v1_2_17.py \
--gt_main_dataset_root='/projectnb/ivc-ml/usmn/data/guess_disent/' \
--gt_main_attr_clf_model_root='/projectnb/ivc-ml/usmn/data/attr_models/' \
--gt_dataset_name=dshapes_fhue_shape_vs_ori_ohue --output_dir=${OUTPUT} \
--load_size=64 --crop_size=64 --flip=false --guess_loss_weight=0.05 --identity_loss_weight=1.0 \
--defence_noise_sigma=0.1 --style_noise_sigma=0.2 --batch_size=16 --cycle_swap_weight=0.0 --style_swap_rec_weight=0.0 \
--style_rand_rec_weight=0.0 --style_norm_weight=0.7 --gt_data_weight=0.0 --cycle_loss_weight=10.0 \
--gen_lr=1e-4 --dis_lr=1e-4 --shuffle_supervised_pairs_buffer=1 \
; done

attr/(.*?)gt|attr/total

% ---

previous best synaction from /scratch3/run/honest_disent/synact_v3/210_sn05_st1_ct3_srr0_dz09_sz01_gs2_cyc10_row20_shuf/0926-1649_1/settings.yml

style_norm_weight: 0.5
style_noise_sigma: 0.1
guess_loss_weight: 2.0
defence_noise_sigma: 0.9
cycle_trans_weight: 3.0
style_trans_rec_weight: 1.0

for i in 1 2 3; do \
EXP=synact_v3/17_rep_best_old_sn05_sz01_gs2_dn09_csw3_ssw1_shuf; \
EXP_ROOT=/projectnb/ivc-ml/usmn/run/honest_disent; XID=$(date +'%m%d-%H%M')_${i}; \
OUTPUT=${EXP_ROOT}/${EXP}/${XID}/; echo ${OUTPUT}; mkdir -p ${OUTPUT}; \
qsub -j y -m ea -N ${EXP/\//_}_${XID} -o ${OUTPUT}/log.txt \
-v OMP_NUM_THREADS=3,TF_NUM_INTEROP_THREADS=3,TF_NUM_INTRAOP_THREADS=1 \
-l gpus=1 -pe omp 3 ~/launch.sh python train_disent_v1_2_17.py \
--gt_main_dataset_root='/projectnb/ivc-ml/usmn/data/guess_disent/' \
--gt_main_attr_clf_model_root='/projectnb/ivc-ml/usmn/data/attr_models/' \
--gt_dataset_name=synaction_bg_vs_idt_v3 --output_dir=${OUTPUT} \
--load_size=64 --crop_size=64 --flip=false --guess_loss_weight=2.0 --identity_loss_weight=1.0 \
--defence_noise_sigma=0.9 --style_noise_sigma=0.1 --batch_size=16 --cycle_swap_weight=3.0 --style_swap_rec_weight=1.0 \
--style_rand_rec_weight=0.0 --style_norm_weight=0.5 --gt_data_weight=0.0 --cycle_loss_weight=10.0 \
--gen_lr=1e-4 --dis_lr=1e-4 --shuffle_supervised_pairs_buffer=1 --log_hidden_metrics_every=10000 \
; done

% ---

for i in 1 2 3; do \
EXP=synact_v3/17_sn05_sz01_gs005_dn05_csw3_ssw1_shuf; \
EXP_ROOT=/projectnb/ivc-ml/usmn/run/honest_disent; XID=$(date +'%m%d-%H%M')_${i}; \
OUTPUT=${EXP_ROOT}/${EXP}/${XID}/; echo ${OUTPUT}; mkdir -p ${OUTPUT}; \
qsub -j y -m ea -N ${EXP/\//_}_${XID} -o ${OUTPUT}/log.txt \
-v OMP_NUM_THREADS=3,TF_NUM_INTEROP_THREADS=3,TF_NUM_INTRAOP_THREADS=1 \
-l gpus=1 -pe omp 3 ~/launch.sh python train_disent_v1_2_17.py \
--gt_main_dataset_root='/projectnb/ivc-ml/usmn/data/guess_disent/' \
--gt_main_attr_clf_model_root='/projectnb/ivc-ml/usmn/data/attr_models/' \
--gt_dataset_name=synaction_bg_vs_idt_v3 --output_dir=${OUTPUT} \
--load_size=64 --crop_size=64 --flip=false --guess_loss_weight=0.05 --identity_loss_weight=1.0 \
--defence_noise_sigma=0.5 --style_noise_sigma=0.1 --batch_size=16 --cycle_swap_weight=3.0 --style_swap_rec_weight=1.0 \
--style_rand_rec_weight=0.0 --style_norm_weight=0.5 --gt_data_weight=0.0 --cycle_loss_weight=10.0 \
--gen_lr=1e-4 --dis_lr=1e-4 --shuffle_supervised_pairs_buffer=1 --log_hidden_metrics_every=10000 \
; done

% ---

for i in 1 2 3; do \
EXP=synact_v3/17_sn05_sz01_gs005_dn09_csw3_ssw1_shuf; \
EXP_ROOT=/projectnb/ivc-ml/usmn/run/honest_disent; XID=$(date +'%m%d-%H%M')_${i}; \
OUTPUT=${EXP_ROOT}/${EXP}/${XID}/; echo ${OUTPUT}; mkdir -p ${OUTPUT}; \
qsub -j y -m ea -N ${EXP/\//_}_${XID} -o ${OUTPUT}/log.txt \
-v OMP_NUM_THREADS=3,TF_NUM_INTEROP_THREADS=3,TF_NUM_INTRAOP_THREADS=1 \
-l gpus=1 -pe omp 3 ~/launch.sh python train_disent_v1_2_17.py \
--gt_main_dataset_root='/projectnb/ivc-ml/usmn/data/guess_disent/' \
--gt_main_attr_clf_model_root='/projectnb/ivc-ml/usmn/data/attr_models/' \
--gt_dataset_name=synaction_bg_vs_idt_v3 --output_dir=${OUTPUT} \
--load_size=64 --crop_size=64 --flip=false --guess_loss_weight=0.05 --identity_loss_weight=1.0 \
--defence_noise_sigma=0.9 --style_noise_sigma=0.1 --batch_size=16 --cycle_swap_weight=3.0 --style_swap_rec_weight=1.0 \
--style_rand_rec_weight=0.0 --style_norm_weight=0.5 --gt_data_weight=0.0 --cycle_loss_weight=10.0 \
--gen_lr=1e-4 --dis_lr=1e-4 --shuffle_supervised_pairs_buffer=1 --log_hidden_metrics_every=10000 \
; done


% ---

for i in 1 2 3; do \
EXP=synact_v3/17_sn05_sz01_gs005_dn09_csw3_ssw1_shuf; \
EXP_ROOT=/projectnb/ivc-ml/usmn/run/honest_disent; XID=$(date +'%m%d-%H%M')_${i}; \
OUTPUT=${EXP_ROOT}/${EXP}/${XID}/; echo ${OUTPUT}; mkdir -p ${OUTPUT}; \
qsub -j y -m ea -N ${EXP/\//_}_${XID} -o ${OUTPUT}/log.txt \
-v OMP_NUM_THREADS=3,TF_NUM_INTEROP_THREADS=3,TF_NUM_INTRAOP_THREADS=1 \
-l gpus=1 -pe omp 3 ~/launch.sh python train_disent_v1_2_17.py \
--gt_main_dataset_root='/projectnb/ivc-ml/usmn/data/guess_disent/' \
--gt_main_attr_clf_model_root='/projectnb/ivc-ml/usmn/data/attr_models/' \
--restore_from=/projectnb/ivc-ml/usmn/run/honest_disent/synact_v3/17_sn05_sz01_gs005_dn09_csw3_ssw1_shuf/0220-1136_3/best/ckpt \
--gt_dataset_name=synaction_bg_vs_idt_v3 --output_dir=${OUTPUT} \
--load_size=64 --crop_size=64 --flip=false --guess_loss_weight=0.05 --identity_loss_weight=1.0 \
--defence_noise_sigma=0.9 --style_noise_sigma=0.1 --batch_size=16 --cycle_swap_weight=3.0 --style_swap_rec_weight=1.0 \
--style_rand_rec_weight=0.0 --style_norm_weight=0.5 --gt_data_weight=0.0 --cycle_loss_weight=10.0 \
--gen_lr=1e-4 --dis_lr=1e-4 --shuffle_supervised_pairs_buffer=1 --log_hidden_metrics_every=10000 \
; done

% ---

for i in 1 2 3; do \
EXP=synact_v3/17_sn05_sz01_gs003_dn09_csw3_ssw1_shuf; \
EXP_ROOT=/projectnb/ivc-ml/usmn/run/honest_disent; XID=$(date +'%m%d-%H%M')_${i}; \
OUTPUT=${EXP_ROOT}/${EXP}/${XID}/; echo ${OUTPUT}; mkdir -p ${OUTPUT}; \
qsub -j y -m ea -N ${EXP/\//_}_${XID} -o ${OUTPUT}/log.txt \
-v OMP_NUM_THREADS=3,TF_NUM_INTEROP_THREADS=3,TF_NUM_INTRAOP_THREADS=1 \
-l gpus=1 -pe omp 3 ~/launch.sh python train_disent_v1_2_17.py \
--gt_main_dataset_root='/projectnb/ivc-ml/usmn/data/guess_disent/' \
--gt_main_attr_clf_model_root='/projectnb/ivc-ml/usmn/data/attr_models/' \
--gt_dataset_name=synaction_bg_vs_idt_v3 --output_dir=${OUTPUT} \
--load_size=64 --crop_size=64 --flip=false --guess_loss_weight=0.03 --identity_loss_weight=1.0 \
--defence_noise_sigma=0.9 --style_noise_sigma=0.1 --batch_size=16 --cycle_swap_weight=3.0 --style_swap_rec_weight=1.0 \
--style_rand_rec_weight=0.0 --style_norm_weight=0.5 --gt_data_weight=0.0 --cycle_loss_weight=10.0 \
--gen_lr=1e-4 --dis_lr=1e-4 --shuffle_supervised_pairs_buffer=1 --log_hidden_metrics_every=10000 \
; done

% ---

for i in 1 2 3; do \
EXP=synact_v3/17_sn05_sz01_gs005_dn09_csw3_ssw1_shuf; \
EXP_ROOT=/projectnb/ivc-ml/usmn/run/honest_disent; XID=$(date +'%m%d-%H%M')_${i}; \
OUTPUT=${EXP_ROOT}/${EXP}/${XID}/; echo ${OUTPUT}; mkdir -p ${OUTPUT}; \
qsub -j y -m ea -N ${EXP/\//_}_${XID} -o ${OUTPUT}/log.txt \
-v OMP_NUM_THREADS=3,TF_NUM_INTEROP_THREADS=3,TF_NUM_INTRAOP_THREADS=1 \
-l gpus=1 -pe omp 3 ~/launch.sh python train_disent_v1_2_17.py \
--gt_main_dataset_root='/projectnb/ivc-ml/usmn/data/guess_disent/' \
--gt_main_attr_clf_model_root='/projectnb/ivc-ml/usmn/data/attr_models/' \
--restore_from=/projectnb/ivc-ml/usmn/run/honest_disent/synact_v3/17_sn05_sz01_gs005_dn09_csw3_ssw1_shuf/0221-0914_2/best/ckpt \
--gt_dataset_name=synaction_bg_vs_idt_v3 --output_dir=${OUTPUT} \
--load_size=64 --crop_size=64 --flip=false --guess_loss_weight=0.05 --identity_loss_weight=1.0 \
--defence_noise_sigma=0.9 --style_noise_sigma=0.1 --batch_size=16 --cycle_swap_weight=3.0 --style_swap_rec_weight=1.0 \
--style_rand_rec_weight=0.0 --style_norm_weight=0.5 --gt_data_weight=0.0 --cycle_loss_weight=10.0 \
--gen_lr=1e-4 --dis_lr=1e-4 --shuffle_supervised_pairs_buffer=1 --log_hidden_metrics_every=10000 \
; done

% ---

for i in 1 2 3; do \
EXP=celeba/217_sn1_ssw1_csw3_dz1_2_sz03_gs4_cyc10_glr1e4_dlr5e5; \
EXP_ROOT=/projectnb/ivc-ml/usmn/run/honest_disent; XID=$(date +'%m%d-%H%M')_${i}; \
OUTPUT=${EXP_ROOT}/${EXP}/${XID}/; echo ${OUTPUT}; mkdir -p ${OUTPUT}; \
qsub -j y -m ea -N ${EXP/\//_}_${XID} -o ${OUTPUT}/log.txt \
-v OMP_NUM_THREADS=3,TF_NUM_INTEROP_THREADS=3,TF_NUM_INTRAOP_THREADS=1 \
-l gpus=1 -pe omp 3 ~/launch.sh python train_disent_v1_2_17.py \
--gt_main_dataset_root='/projectnb/ivc-ml/usmn/data/guess_disent/' \
--gt_main_attr_clf_model_root='/projectnb/ivc-ml/usmn/data/attr_models/' \
--gt_dataset_name=celeba_custom_split_sw2 --output_dir=${OUTPUT} \
--load_size=64 --crop_size=64 --flip=false \
--guess_loss_weight=4.0 --identity_loss_weight=1.0 --defence_noise_sigma=1.2 \
--style_noise_sigma=0.3 --batch_size=8 --cycle_swap_weight=3.0 \
--style_swap_rec_weight=1.0 --style_norm_weight=1.0 --gt_data_weight=0.0 \
--cycle_loss_weight=10.0 --gen_lr=0.0001 --dis_lr=5e-5 \
--shuffle_supervised_pairs_buffer=100 --log_hidden_metrics_every=10000 \
; done

% ---

for i in 1 2 3; do \
EXP=celeba/217_sn1_ssw1_csw3_dz05_sz03_gs005_cyc10_glr1e4_dlr5e5; \
EXP_ROOT=/projectnb/ivc-ml/usmn/run/honest_disent; XID=$(date +'%m%d-%H%M')_${i}; \
OUTPUT=${EXP_ROOT}/${EXP}/${XID}/; echo ${OUTPUT}; mkdir -p ${OUTPUT}; \
qsub -j y -m ea -N ${EXP/\//_}_${XID} -o ${OUTPUT}/log.txt \
-v OMP_NUM_THREADS=3,TF_NUM_INTEROP_THREADS=3,TF_NUM_INTRAOP_THREADS=1 \
-l gpus=1 -pe omp 3 ~/launch.sh python train_disent_v1_2_17.py \
--gt_main_dataset_root='/projectnb/ivc-ml/usmn/data/guess_disent/' \
--gt_main_attr_clf_model_root='/projectnb/ivc-ml/usmn/data/attr_models/' \
--gt_dataset_name=celeba_custom_split_sw2 --output_dir=${OUTPUT} \
--load_size=64 --crop_size=64 --flip=false \
--guess_loss_weight=0.05 --identity_loss_weight=1.0 --defence_noise_sigma=0.5 \
--style_noise_sigma=0.3 --batch_size=8 --cycle_swap_weight=3.0 \
--style_swap_rec_weight=1.0 --style_norm_weight=1.0 --gt_data_weight=0.0 \
--cycle_loss_weight=10.0 --gen_lr=0.0001 --dis_lr=5e-5 \
--shuffle_supervised_pairs_buffer=100 --log_hidden_metrics_every=10000 \
; done
